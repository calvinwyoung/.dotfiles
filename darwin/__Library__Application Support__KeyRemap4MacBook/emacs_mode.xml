<?xml version="1.0"?>
<root>
  <!-- Enable Emacs keys everywhere, even in places where DefaultKeyBinding.dict
       doesn't apply.
  -->
  <item>
    <name>Emacs Mode</name>
    <identifier>custom.emacs_mode {{ CAPSLOCK_OR_NONE }}</identifier>
    <appendix>With modifier {{ CAPSLOCK_OR_NONE }}</appendix>
    <appendix>(Except in Emacs, Terminal, Virtual Machines, etc.)</appendix>

    <not>{{ EMACS_MODE_IGNORE_APPS }}</not>

    <!-- Home -->
    <autogen>
      __KeyToKey__
      KeyCode::A, ModifierFlag::CONTROL_L | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_LEFT, ModifierFlag::COMMAND_L
    </autogen>

    <!-- End -->
    <autogen>
      __KeyToKey__
      KeyCode::E, ModifierFlag::CONTROL_L | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_RIGHT, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Delete word backward -->
    <autogen>
      __KeyToKey__
      KeyCode::W, ModifierFlag::CONTROL_L | {{ CAPSLOCK_OR_NONE }},

      KeyCode::DELETE, ModifierFlag::OPTION_L
    </autogen>

    <!-- Delete word forward -->
    <autogen>
      __KeyToKey__
      KeyCode::D, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::FORWARD_DELETE, ModifierFlag::OPTION_L
    </autogen>

    <!-- Copy -->
    <autogen>
      __KeyToKey__
      KeyCode::W, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::C, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Yank / Paste -->
    <autogen>
      __KeyToKey__
      KeyCode::Y, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | {{ CAPSLOCK_OR_NONE }},

      KeyCode::V, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Undo -->
    <autogen>
      __KeyToKey__
      KeyCode::SLASH, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | {{ CAPSLOCK_OR_NONE }},

      KeyCode::Z, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Redo -->
    <autogen>
      __KeyToKey__
      KeyCode::SLASH, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::Z, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L
    </autogen>

    <!-- Move cursor forward by one word -->
    <autogen>
      __KeyToKey__
      KeyCode::F, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_RIGHT, ModifierFlag::OPTION_L
    </autogen>

    <!-- Move cursor backward by one word -->
    <autogen>
      __KeyToKey__
      KeyCode::B, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_LEFT, ModifierFlag::OPTION_L
    </autogen>

    <!-- Move cursor to first non-whitespace character in line -->
    <autogen>
      __KeyToKey__
      KeyCode::M, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::A, ModifierFlag::CONTROL_L,
      KeyCode::CURSOR_RIGHT, ModifierFlag::OPTION_L,
      KeyCode::CURSOR_LEFT, ModifierFlag::OPTION_L
    </autogen>

    <!-- Move cursor to top of file -->
    <autogen>
      __KeyToKey__
      KeyCode::COMMA, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_SHIFT | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_UP, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Move cursor to bottom of file -->
    <autogen>
      __KeyToKey__
      KeyCode::DOT, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_SHIFT | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_DOWN, ModifierFlag::COMMAND_L
    </autogen>

    <!-- Open new line below current line -->
    <autogen>
      __KeyToKey__
      KeyCode::O, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | {{ CAPSLOCK_OR_NONE }},

      KeyCode::E, ModifierFlag::CONTROL_L,
      KeyCode::RETURN
    </autogen>

    <!-- Open new line above current line -->
    <autogen>
      __KeyToKey__
      KeyCode::O, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::A, ModifierFlag::CONTROL_L,
      KeyCode::CURSOR_UP,
      KeyCode::E, ModifierFlag::CONTROL_L,
      KeyCode::RETURN
    </autogen>

    <!-- Move cursor up by 5 lines -->
    <autogen>
      __KeyToKey__
      KeyCode::P, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_UP,
      KeyCode::CURSOR_UP,
      KeyCode::CURSOR_UP,
      KeyCode::CURSOR_UP,
      KeyCode::CURSOR_UP
    </autogen>

    <!-- Move cursor down by 5 lines -->
    <autogen>
      __KeyToKey__
      KeyCode::N, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::CURSOR_DOWN,
      KeyCode::CURSOR_DOWN,
      KeyCode::CURSOR_DOWN,
      KeyCode::CURSOR_DOWN,
      KeyCode::CURSOR_DOWN
    </autogen>

    <!-- Scroll up -->
    <autogen>
      __KeyToKey__
      KeyCode::P, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::VK_MOUSEKEY_SCROLL_UP
    </autogen>

    <!-- Scroll down -->
    <autogen>
      __KeyToKey__
      KeyCode::N, MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_CONTROL | MODIFIERFLAG_EITHER_LEFT_OR_RIGHT_OPTION | {{ CAPSLOCK_OR_NONE }},

      KeyCode::VK_MOUSEKEY_SCROLL_DOWN
    </autogen>
  </item>
</root>
